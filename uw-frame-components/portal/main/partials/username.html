<div ng-controller="SessionCheckController as sessionCtrl">
  <div class='username-option' ng-show='GuestMode'>
    <a ng-href="{{MISC_URLS.myuwHome}}" class='btn btn-flat' title='Login' target='_self'>Login</a>
  </div>
  <div ng-hide='GuestMode' class='username-option' ng-click='usernameOptionOpen=!usernameOptionOpen'>
    <!-- <img src='img/bucky.png' class='gravatar' ng-if="!$storage.useGravatar">
    <img gravatar-src="'{{sessionCtrl.user.email}}'" class='gravatar' gravatar-size="50" ng-if="$storage.useGravatar"> -->
    {{sessionCtrl.user.firstName ? sessionCtrl.user.firstName : sessionCtrl.user.displayName}}
    <i class="fa fa-caret-down"
       popover-template="'usermenu.html'"
       popover-is-open="usernameOptionOpen"
       popover-placement="bottom"
       popover-trigger="none"></i>
  </div>
  <script type="text/ng-template" id="usermenu.html">
    <div role="navigation" aria-label="Main menu" class='username-menu-template'>
      <ul role="menubar" aria-hidden="false" class='no-padding'>
        <li role="menuitem" aria-haspopup="true">
          <!-- <img src='img/bucky.png' class='gravatar' ng-if="!$storage.useGravatar">
           <img gravatar-src="'{{sessionCtrl.user.email}}'" class='gravatar' gravatar-size="50" ng-if="$storage.useGravatar"> -->
          {{sessionCtrl.user.displayName}}
        </li>
        <li role="menuitem" ng-if='$storage.showSettings'>
          <a tabindex="-1" href="settings" class='settings-link' title='Settings'>Beta Settings</a>
        </li>
        <li role="menuitem" ng-if='APP_FLAGS.showUserSettingsPage'>
          <a tabindex="-1" href="user-settings" class='settings-link' title='Settings'>Settings</a>
        </li>
        <li role="menuitem">
          <a tabindex="-1" ng-href="{{MISC_URLS.logoutURL}}" class='logout-link' title='Logout' target='_self'>Sign out</a>
        </li>
      </ul>
    </div>
  </script>
</div>
